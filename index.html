
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Layout com Imagens e Calculadora</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<div class="container" ondblclick="openFullscreen()">
    <!-------- Poker Hands ---------->
    <div class="section">
        <label class="pokerHand" for="carta-alta">
            <input type="radio" id="carta-alta" name="hand" value="1" checked> + 1 - CARTA ALTA
        </label>
        
        <label class="pokerHand" for="par">
            <input type="radio" id="par" name="hand" value="2"> + 2 - PAR
        </label>
        
        <label class="pokerHand" for="dois-pares">
            <input type="radio" id="dois-pares" name="hand" value="3"> + 3 - DOIS PARES 
        </label>
        
        <label class="pokerHand" for="trinca">
            <input type="radio" id="trinca" name="hand" value="4"> + 4 - TRINCA 
        </label>
        
        <label class="pokerHand" for="sequencia">
            <input type="radio" id="sequencia" name="hand" value="5"> + 5 - SEQU√äNCIA 
        </label>
        
        <label class="pokerHand" for="flush">
            <input type="radio" id="flush" name="hand" value="6"> + 6 - FLUSH 
        </label>
        
        <label class="pokerHand" for="full-house">
            <input type="radio" id="full-house" name="hand" value="7"> + 7 - FULL HOUSE
        </label>
        
        <label class="pokerHand" for="quadra">
            <input type="radio" id="quadra" name="hand" value="8"> + 8 - QUADRA 
        </label>
        
        <label class="pokerHand" for="straight-flush">
            <input type="radio" id="straight-flush" name="hand" value="9"> + 9 - ST. FLUSH
        </label>
        
        <label class="pokerHand" for="royal-straight-flush">
            <input type="radio" id="royal-straight-flush" name="hand" value="10"> + 10 - ROYAL
        </label>  
    </div>

    <!-------- Coringas ---------->
    <div class="section">
        <img id="imagem1" onclick="addPontos(this)"  src="placeholder.jpg" alt="Imagem 1" class="visible">
        <span class="contadorSpan" id = "contadorSpan1">0</span>
        <span class="indicadorMult" id = "indicadorMult1">0</span>
        <br>
        <button onclick="infoCarta(pIdCoringa1)">Info</button>
    </div>
    <div class="section">
        <img id="imagem2" onclick="addPontos(this)"  src="placeholder.jpg" alt="Imagem 2" class="visible">
        <span class="contadorSpan" id = "contadorSpan2">0</span>
        <span class="indicadorMult" id = "indicadorMult2">0</span>
        <br>
        <button onclick="infoCarta(pIdCoringa2)">Info</button>
    </div>

    <!-------- Pontos ---------->
    <div class="calculator-section">
        <div class="button-row">
            <button class="botaoLargo" onclick="SortCoringas()">üé≤ üÉè</button>             
        </div>
        <br>
        <div class="button-row">
        <input onclick="setJogador(true)" ondblclick="excluir2()" readonly type="text" id="valorEntrada" placeholder="J1">
        <input onclick="setJogador(false)" ondblclick="excluir2()" readonly type="text" id="valorEntrada2" placeholder="J2">
        </div>
        <div class="button-row">
        <input type="text" id="valorSoma" readonly ondblclick="excluir()" onclick="setJogador(true)" value=0 placeholder="Valor da soma at√© agora" readonly>
        <input type="text" id="valorSoma2" readonly ondblclick="excluir()" onclick="setJogador(false)" value=0 placeholder="Total Jogador 2" readonly>
        </div>
        <br>
        <div class="button-row">
            <button class="botaoLargo" onclick="adicionar()">‚úì</button>      
        </div>
        <br>
        <div class="button-row">
            <button class="botaoCookie" onclick="AtualizaCookie()">Fim do Jogo</button>
            <button class="botaoCookie" onclick="ExibeCookie()">Top da Mesa</button>       
        </div>
        <div class="button-row">
            <label id="TopDaMesa" class="TopDaMesa">Top da Mesa: </label>      
        </div>
    </div>
</div>


<input type="file" id="selecionarImagemInput2" class="hidden" accept="image/*">

<input type="file" id="selecionarImagemInput3" class="hidden" accept="image/*">

<script>
var total = 0;
var jogador1Selecionado =true;
let pasta = '';
var pIdCoringa1;
var pIdCoringa2;
var radios = document.querySelectorAll('input[type="radio"][name="hand"]');
var vPontuacaoLogJ1 = ""; 
var vPontuacaoLogJ2 = "";

//Coringas
let arrayOfCoringa = [
    {
        Id: 0,
        Descricao: "Dummy",
        EhMult: false,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 1,
        Descricao: "1 - Ouro +2",
        EhMult: false,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 2,
        Descricao: "2 - quando 0 descartes, x2",
        EhMult: true,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 3,
        Descricao: "3 - A +5",
        EhMult: false,
        ValorBase: 5,
        QtdAtivacoes: 0
    },
    {
        Id: 4,
        Descricao: "4 - Face +2",
        EhMult: false,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 5,
        Descricao: "5 - Straight e straight flush x2",
        EhMult: true,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 6,
        Descricao: "6 - Cada Par +3",
        EhMult: false,
        ValorBase: 3,
        QtdAtivacoes: 0
    },
    {
        Id: 7,
        Descricao: "7 - Carta Impar +2",
        EhMult: false,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 8,
        Descricao: "8 - Carta par +2",
        EhMult: false,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 9,
        Descricao: "9 - Straight e straight flush com 4 cartas",
        EhMult: false,
        ValorBase: 0,
        QtdAtivacoes: 0
    },
    {
        Id: 10,
        Descricao: "10 - Jogar 4 cartas x2",
        EhMult: true,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 11,
        Descricao: "11 - Score com 4 naipes diferentes x2",
        EhMult: true,
        ValorBase: 2,
        QtdAtivacoes: 0
    },
    {
        Id: 12,
        Descricao: "12 - Tudo vermelho √© ouro",
        EhMult: false,
        ValorBase: 0,
        QtdAtivacoes: 0
    }
];

window.onload = function() {
    radios.forEach(function(radio) {
        radio.onclick = function() {
            CalculaPontuacao();
        };
    });

    setJogador(1);
};

function atualizaContador(pImagem){
    contadorSpan1 = document.getElementById('contadorSpan1');
    contadorSpan2 = document.getElementById('contadorSpan2');

    contadorSpan1.textContent = arrayOfCoringa[pIdCoringa1].QtdAtivacoes;
    contadorSpan2.textContent = arrayOfCoringa[pIdCoringa2].QtdAtivacoes;   
}

function addPontos(pImagem) {
    arrayOfCoringa[pImagem.value].QtdAtivacoes++; 
    
    pImagem.style.border = "4px solid red";

    atualizaContador(pImagem);

    CalculaPontuacao(); 
}

function CalculaPontuacao(){
    totalCalculo = 1;

    totalCalculo = parseFloat(document.querySelector('input[name="hand"]:checked').value);
        
    //Dois coringas s√£o de somar
    if ((arrayOfCoringa[pIdCoringa1].EhMult == false) && (arrayOfCoringa[pIdCoringa2].EhMult == false)){
        totalCalculo += arrayOfCoringa[pIdCoringa1].ValorBase * arrayOfCoringa[pIdCoringa1].QtdAtivacoes;
        totalCalculo += arrayOfCoringa[pIdCoringa2].ValorBase * arrayOfCoringa[pIdCoringa2].QtdAtivacoes;
    } 
    //Primeiro coringa √© soma, segundo √© mult
    else if ((arrayOfCoringa[pIdCoringa1].EhMult == false) && (arrayOfCoringa[pIdCoringa2].EhMult == true)){
        totalCalculo += arrayOfCoringa[pIdCoringa1].ValorBase * arrayOfCoringa[pIdCoringa1].QtdAtivacoes;
        if (arrayOfCoringa[pIdCoringa2].QtdAtivacoes > 0){
            totalCalculo = totalCalculo * arrayOfCoringa[pIdCoringa2].ValorBase * arrayOfCoringa[pIdCoringa2].QtdAtivacoes;
        }
    }   
    //Segunda coringa √© soma, primeiro √© mult
    else if ((arrayOfCoringa[pIdCoringa2].EhMult == false) && (arrayOfCoringa[pIdCoringa1].EhMult == true)){
        totalCalculo += arrayOfCoringa[pIdCoringa2].ValorBase * arrayOfCoringa[pIdCoringa2].QtdAtivacoes;
        if (arrayOfCoringa[pIdCoringa1].QtdAtivacoes > 0){
            totalCalculo = totalCalculo * arrayOfCoringa[pIdCoringa1].ValorBase * arrayOfCoringa[pIdCoringa1].QtdAtivacoes;
        }
    }   
    //Dois coringas s√£o mult
    else if ((arrayOfCoringa[pIdCoringa2].EhMult == true) && (arrayOfCoringa[pIdCoringa1].EhMult == true)){
        if (arrayOfCoringa[pIdCoringa1].QtdAtivacoes > 0){
            totalCalculo = totalCalculo * arrayOfCoringa[pIdCoringa1].ValorBase * arrayOfCoringa[pIdCoringa1].QtdAtivacoes;
        }

        if (arrayOfCoringa[pIdCoringa2].QtdAtivacoes > 0){
            totalCalculo = totalCalculo * arrayOfCoringa[pIdCoringa2].ValorBase * arrayOfCoringa[pIdCoringa2].QtdAtivacoes;
        }
    }  


    if(jogador1Selecionado) {
        document.getElementById("valorEntrada").value = totalCalculo;
    } else {
        document.getElementById("valorEntrada2").value = totalCalculo;
    }  
}

function setJogador(pJog){
   jogador1Selecionado = pJog;
   
   PintaEditJogadorSelcionado(pJog);
}

function adicionarNumero(numero) {
    
    if(jogador1Selecionado) {
     document.getElementById("valorEntrada").value += numero;
    } else {
    document.getElementById("valorEntrada2").value += numero;
    }
}


function excluir (){
    ResetaCoringas();

  if(jogador1Selecionado) {
    document.getElementById("valorSoma").value = 0;
   } else {
       document.getElementById("valorSoma2").value = 0;
   }
}

function excluir2 (){
    ResetaCoringas();
    
   if (jogador1Selecionado) {
      document.getElementById("valorEntrada").value = ""; 
      
   } else {
        document.getElementById("valorEntrada2").value = "";
   }
}

function ResetaCoringas(){
    document.getElementById("imagem1").style.border = ""; 
    document.getElementById("imagem2").style.border = ""; 
    arrayOfCoringa[pIdCoringa1].QtdAtivacoes = 0;
    arrayOfCoringa[pIdCoringa2].QtdAtivacoes = 0;
    contadorSpan1.textContent = 0;
    contadorSpan2.textContent = 0; 

    document.getElementById("valorEntrada").value = ""; 
    document.getElementById("valorEntrada2").value = ""; 
}

function adicionar() {
    if (jogador1Selecionado){
        var entrada = parseFloat(document.getElementById("valorEntrada").value);
    } else {
        var entrada = parseFloat(document.getElementById("valorEntrada2").value);
    }
    
    if (!isNaN(entrada)) {
        if(jogador1Selecionado){
            total = parseFloat(document.getElementById("valorSoma").value);
        total = total + entrada;
            document.getElementById("valorSoma").value = total;
        } else {
            total = parseFloat(document.getElementById("valorSoma2").value);
            total = total + entrada;
            document.getElementById("valorSoma2").value = total;
        }
       
        document.getElementById("valorEntrada").value = "";
        document.getElementById("valorEntrada2").value = "";

        // AdicionaNoLog(jogador1Selecionado, entrada);

        ResetaCoringas();
    } else {
        alert("Por favor, digite um n√∫mero v√°lido.");
    }
}

function cancelar() {
    document.getElementById("valorEntrada").value = 0;
}


function selecionarImagem2(idImagem) {
    var input = document.getElementById("selecionarImagemInput2");
    input.addEventListener("change", function() {
        var file = input.files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById(idImagem).src = e.target.result;
        }
        reader.readAsDataURL(file);
    });
    input.click();
}

function selecionarImagem3(idImagem) {
    var input = document.getElementById("selecionarImagemInput3");
    input.addEventListener("change", function() {
        var file = input.files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById(idImagem).src = e.target.result;
        }
        reader.readAsDataURL(file);
    });
    input.click();
}

function getRandomIndex(indices) {
    const randomIndex = Math.floor(Math.random() * indices.length);
    return indices.splice(randomIndex, 1)[0];
}

function atualizaIndicadorMult(){
    indicadorMult1 = document.getElementById('indicadorMult1');
    if (arrayOfCoringa[pIdCoringa1].EhMult) {
        pOperacao = "X";
    } else {
        pOperacao = "+";    
    }
    indicadorMult1.textContent = pOperacao + " " + arrayOfCoringa[pIdCoringa1].ValorBase;

    indicadorMult2 = document.getElementById('indicadorMult2');
    if (arrayOfCoringa[pIdCoringa2].EhMult) {
        pOperacao = "X";
    } else {
        pOperacao = "+";    
    }
    indicadorMult2.textContent = pOperacao + " " + arrayOfCoringa[pIdCoringa2].ValorBase;
}

function SortCoringas() {
    pasta = 'https://viniciusbemfica.github.io/Cartas/';

    // N√∫mero total de imagens dispon√≠veis na pasta
    const totalImagens = 12;

    // Lista de √≠ndices de imagens dispon√≠veis
    let indicesDisponiveis = Array.from({ length: totalImagens }, (_, i) => i + 1);

    // Gerar dois n√∫meros aleat√≥rios entre 1 e o total de imagens
    const random1 = getRandomIndex(indicesDisponiveis);
    const random2 = getRandomIndex(indicesDisponiveis);

    pIdCoringa1 = random1;
    pIdCoringa2 = random2;

    // Criar o caminho para as imagens aleat√≥rias
    const caminhoImagem1 = `${pasta}${random1}.jpg`;
    const caminhoImagem2 = `${pasta}${random2}.jpg`;

    // Atualizar as imagens no HTML
    document.getElementById('imagem1').src = caminhoImagem1;
    document.getElementById('imagem2').src = caminhoImagem2;

    document.getElementById("imagem1").value = pIdCoringa1;
    document.getElementById("imagem2").value = pIdCoringa2;

    ResetaCoringas();
    atualizaIndicadorMult();
    atualizaContador(); 

    var vCookieString = getCookie("CookieLog"); 
    vTopoDaMesa = encontrarMaiorPontuacaoEJogador(vCookieString, pIdCoringa1, pIdCoringa2);
    document.getElementById("TopDaMesa").textContent = 'Top da Mesa: ';
    document.getElementById("TopDaMesa").textContent += vTopoDaMesa;
}

function infoCarta(pIdCoringa){
    alert(arrayOfCoringa[pIdCoringa].Descricao);
}

function AtualizaCookie() { 
    var vCookieString = getCookie("CookieLog");   
        
    if (vCookieString != "" && vCookieString !== null) {     
        vCookieString = CookieAtualizaLog(vCookieString); 
        setCookie("CookieLog", vCookieString, 30);      
    } else { 
        setCookie("CookieLog", "Inicio;", 30); 
    }    

    ExibeCookie();
} 

function getCookie(c_name) {
    return localStorage.getItem(c_name);
}

function setCookie(c_name, value, expiredays) {
    return localStorage.setItem(c_name, value);
}

function CookieAtualizaLog(pLogAntes){     
    vAdicionarNoLog =  '\n' + 'C1|' + pIdCoringa1 + '|C2|' + pIdCoringa2 + '|';  

    if (document.getElementById("valorSoma").value > document.getElementById("valorSoma2").value){
        vAdicionarNoLog += 'J1|' + document.getElementById("valorSoma").value;
    } else if (document.getElementById("valorSoma2").value > document.getElementById("valorSoma").value) {
        vAdicionarNoLog += 'J2|' + document.getElementById("valorSoma2").value;       
    } else {
        vAdicionarNoLog += 'EMP|' + document.getElementById("valorSoma").value;    
    }

    vLogNovo = pLogAntes + vAdicionarNoLog + ';';

    return vLogNovo;
}

function ExibeCookie(){
    var vCookieString = getCookie("CookieLog"); 

    maiorPontuacao = encontrarMaiorPontuacaoEJogador(vCookieString, pIdCoringa1, pIdCoringa2); 

    vMelhorDaMesa = "----- Melhores da Mesa ----- " + '\n' +
                        "C1: " + arrayOfCoringa[pIdCoringa1].Descricao  + '\n' +
                        "C2: " + arrayOfCoringa[pIdCoringa2].Descricao  + '\n' +
                        "Maior Pontua√ß√£o: " + maiorPontuacao;

    alert(vMelhorDaMesa);
}

function AdicionaNoLog(pjogador1Selecionado, pPontuacao){
    if (pjogador1Selecionado){
        vPontuacaoLogJ1 += pPontuacao + '|';
    } else {
        vPontuacaoLogJ2 += pPontuacao + '|';   
    }   
}

function PintaEditJogadorSelcionado(pJogador){
    if (pJogador == 1){
        document.getElementById("valorEntrada").style.border = "4px solid red";
        document.getElementById("valorEntrada2").style.border = "";
    } else {
        document.getElementById("valorEntrada2").style.border = "4px solid red";
        document.getElementById("valorEntrada").style.border = "";
    }  
}

function openFullscreen() {  
    var elem = document.documentElement;
    if (elem.requestFullscreen) {
        elem.requestFullscreen();
    } else if (elem.mozRequestFullScreen) { /* Firefox */
        elem.mozRequestFullScreen();
    } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari e Opera */
        elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) { /* IE/Edge */
        elem.msRequestFullscreen();
    }   
}


function encontrarMaiorPontuacaoEJogador(vCookieString, pIdCoringa1, pIdCoringa2) {
    // Divide o texto em linhas
    var linhas = vCookieString.split(";");

    // Inicializa a vari√°vel para armazenar a maior pontua√ß√£o e o jogador correspondente
    var maiorPontuacao = 0;

    // Itera sobre cada linha
    for (var i = 0; i < linhas.length; i++) {
        // Divide a linha em elementos separados
        var elementos = linhas[i].split("|");

        // Inicializa as vari√°veis para armazenar as pontua√ß√µes dos Coringas e o jogador correspondente
        var pontuacao = 0;

        // Itera sobre os elementos para encontrar as pontua√ß√µes dos Coringas e o jogador correspondente
        
        if ((elementos[1] == pIdCoringa1) && (elementos[3] == pIdCoringa2) || (elementos[1] == pIdCoringa2) && (elementos[3] == pIdCoringa1)) {
            pontuacao = parseInt(elementos[5], 10);
        }  
        

        // Verifica se h√° uma pontua√ß√£o v√°lida para ambos os Coringas
        if (pontuacao > maiorPontuacao) {
            maiorPontuacao = pontuacao;
        } 
       
    }

    
    // Retorna um objeto contendo a maior pontua√ß√£o e o jogador correspondente
    return (maiorPontuacao);
}

     

</script>

</body>
</html>
